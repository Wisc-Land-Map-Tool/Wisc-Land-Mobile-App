<html>

<head>
    <meta charset="utf-8" />
        <meta name="format-detection" content="telephone=no" />
        <!-- WARNING: for iOS 7, remove the width=device-width and height=device-height attributes. See https://issues.apache.org/jira/browse/CB-4323 -->
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
        <link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.1/jquery.mobile-1.4.1.min.css"/>
        <link rel="stylesheet" href="css/index.css">
        <link rel="stylesheet" href="css/custom.css">
        <script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
        <script src="http://code.jquery.com/mobile/1.4.1/jquery.mobile-1.4.1.min.js"></script>
        <script src="http://maps.googleapis.com/maps/api/js?sensor=true"></script>

</head>

<body onload="init()"> 
    
<div id="loginPage" data-role="page" data-theme="a">

    <div data-theme="a" data-role="header" id="header">
                <strong id="WINGS">Wisconsin Mapping Tool</strong>
     </div>

    <div data-role="content" data-theme="a">    

        <form id="loginForm" data-theme="a">
        <div data-role="fieldcontain" class="ui-hide-label" data-theme="a">
            <label for="email">Email:</label>
            <input type="text" name="email" id="email" value="" placeholder="Email" />
        </div>

        <div data-role="fieldcontain" class="ui-hide-label" data-theme="a"> 
            <label for="password">Password:</label>
            <input type="password" name="password" id="password" value="" placeholder="Password" />
        </div>

        
        </form>
        <button data-role="button" id="loginBtn" data-theme="a">Login</button>
    </div>

        <div data-theme="a" data-role="footer">
        <h3>
            UW-Madison
        </h3>
    </div>
<!-- <script language="javascript" type="text/javascript" src="js/index.js"></script> -->

</div>

<div id="tasksPage" data-role="page" data-theme="a">
        <div data-theme="a" data-role="header" id="header">
                <strong id="WINGS">Wisconsin Mapping Tool</strong>
     </div>


<div data-role="content" data-theme="a">    
        <ul data-role="listview" data-divider-theme="a" data-inset="false">
            <li data-role="list-divider" role="heading">
                Current Tasks
            </li>
            <li data-theme="a">
                <button data-role="button" id="btnData_Entry" data-theme="a">Task 1</button>
            </li>
        </ul> 
</div>


    <div data-theme="a" data-role="footer">
        <h3>
            UW-Madison
        </h3>
    </div>
</div>

<div id="data_entry" data-role="page" data-theme="a">

    <div data-theme="a" data-role="header" id="header">
        <a data-role="button" data-rel="back" href="#page6" class="ui-btn-left" id="back">
            Back
        </a>
        <h5>
            Wisconsin Land Tool
        </h5>
    </div>

    <div data-role="content" data-theme="a">    
        <h3>
            Task Data Entry
        </h3>
        <form action="">
            <div data-role="fieldcontain" data-controltype="selectmenu">
                <label for="selectCoverType">
                    Cover Type
                </label>
                <select id="selectCoverType" name="">
                    <option value="">
                        Select One
                    </option>
                    <option value="1">
                        Urban Developed
                    </option>
                    <option value="2">
                        Agriculture
                    </option>
                    <option value="3">
                        Forest
                    </option>
                    <option value="4">
                        Shrubland
                    </option>
                    <option value="5">
                        Grassland
                    </option>
                    <option value="6">
                        Open Water
                    </option>
                    <option value="7">
                        Barren
                    </option>
                    <option value="8">
                        Wetland
                    </option>
                </select>
            </div>
        <div id="selectCoverType2_div"data-role="fieldcontain" data-controltype="selectmenu">
                <select id="selectCoverType2" name="">
                </select>
            </div>
            <div id="selectCoverType3_div"data-role="fieldcontain" data-controltype="selectmenu">
                <select id="selectCoverType3" name="">
                </select>
            </div>
        </form>
    </div>
    <div data-theme="a" data-role="footer" data-inset="false">
                <h3>
                    UW-Madison
                </h3>
    </div>
</div>

</body>
<script>

var classifications = {1:
                        [{ "text":"High Intensity Urban" , "value":"11" }, 
                        { "text":"Low Intensity Urban" , "value":"12"}],
               
               2:       [{"text":"Row Crops", "value":"21" },
                        {  "text": "Forage Crops", "value":"22"}],
               
               3:       [{"text":"Coniferous", "value":"31" },
                        {  "text": "Broad-leaved Deciduous", "value":"32"},
                        {  "text": "Mixed Coniferous/Broad-leaved Deciduous", "value":"33"},
                        {  "text": "Clearcut/Young Plantation", "value":"34"}],
               
               4:       [{"text":"Upland Shrub", "value":"41" }],

               5:       [{"text":"Grassland", "value":"51" }],

               6:       [{"text":"Open Water", "value":"61" }],
               
               7:       [{"text":"Sand", "value":"71" },
                        {  "text": "Bare Soil", "value":"72"},
                        {  "text": "Exposed Rock", "value":"73"},
                        {  "text": "Mixed", "value":"74"}],
               
               8:       [{"text":"Emergent/Wet Meadow", "value":"81" },
                        {  "text": "Lowland Shrub", "value":"82"},
                        {  "text": "Broad-leaved Evergreen", "value":"83"},
                        {  "text": "Forested Wetland", "value":"84"}],

              82:       [{ "text":"Coniferous" , "value":"821" }, 
                        { "text":"Broad-leaved Deciduous" , "value":"822"}],

              84:       [{"text":"Coniferous", "value":"841" },
                        {  "text": "Broad-leaved Deciduous", "value":"842"},
                        {  "text": "Mixed Coniferous/Broad-leaved Deciduous", "value":"843"}]

                };

function init() {

 document.addEventListener("deviceready", deviceReady, true);
 delete init;
}

$("#loginBtn").click(function (e) {
        var u = $("#email").val();
        var p = $("#password").val();

        $.ajax({
        url: "http://localhost:3000/users/sign_in.json",
        type: "POST",
      
        data: JSON.stringify({user: {email: u, password: p}}),
        dataType: "json",
        contentType: "application/json; charset=utf-8",
        success: function(data){
            alert("Successfully Logging in");

            $(':mobile-pagecontainer').pagecontainer('change', '#tasksPage', {
        transition: 'slide',
        changeHash: false,
        showLoadMsg: true
    });
             
        },
        
        error: function(error) {
            console.log(error.responseText)
            alert(error.responseText);
        }
        
        });


$(document).on("pagecreate", "#tasksPage", function( event ) {
        $.ajax({
        url: "http://localhost:3000/users/1/assignments",
        type: "POST",
      
        data: JSON.stringify({user: {id: 1}}),
        dataType: "json",
        contentType: "application/json; charset=utf-8",
        success: function(data){
            // console.log(data);
            // alert(data);
             
        },
        
        error: function(error) {
            // alert(error.responseText)
            // alert("error alert");
        }
        
        });





});



});

$(document).on("pagecreate", "#data_entry", function( event ) {
    $("#selectCoverType2_div").hide();
    $("#selectCoverType3_div").hide();
});


$("#btnData_Entry").click(function (e) {
    $(':mobile-pagecontainer').pagecontainer('change', '#data_entry', {
        transition: 'slide',
        changeHash: false,
        showLoadMsg: true
    });
});


$("#selectCoverType").change(function() {

    var selected = $(this).val();

    $("#selectCoverType3").empty();
    $("#selectCoverType3_div").hide();

    $("#selectCoverType2").empty();


    if(selected == ""){
        $("#selectCoverType2_div").hide();
        $("#selectCoverType3").selectmenu("refresh");
        return;
    }

    $("#selectCoverType2_div").show();


    var children = classifications[selected];
    console.log(children);

    $('#selectCoverType2').append('<option value=""> Select One </option>');

    for( var i = 0 ; i < children.length; i++ ) {

        $('#selectCoverType2').append('<option value='+ children[i].value +'> ' + children[i].text + ' </option>');

    }

    $("#selectCoverType2").selectmenu("refresh");

});

$("#selectCoverType2").change(function() {

    $("#selectCoverType3").empty();
    
    var selected = $(this).val();
    var children = classifications[selected];

    if(children == null){
        $("#selectCoverType3_div").hide();

        return;
    }

    $("#selectCoverType3_div").show();
    console.log(children);

    $('#selectCoverType3').append('<option value=""> Select One </option>');

    for( var i = 0 ; i < children.length; i++ ) {

        $('#selectCoverType3').append('<option value='+ children[i].value +'> ' + children[i].text + ' </option>');

    }

    $("#selectCoverType3").selectmenu("refresh");

});



















</script>
</html>