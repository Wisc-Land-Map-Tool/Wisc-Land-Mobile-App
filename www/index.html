<html>

<head>
    <meta charset="utf-8" />
        <meta name="format-detection" content="telephone=no" />
        <!-- WARNING: for iOS 7, remove the width=device-width and height=device-height attributes. See https://issues.apache.org/jira/browse/CB-4323 -->
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
        <link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.1/jquery.mobile-1.4.1.min.css"/>
        <link rel="stylesheet" href="css/index.css">
        <link rel="stylesheet" href="css/custom.css">
        <script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
        <script src="http://code.jquery.com/mobile/1.4.1/jquery.mobile-1.4.1.min.js"></script>
        <script src="http://maps.googleapis.com/maps/api/js?sensor=true"></script>

</head>

<body onload="init()"> 
    
<div id="loginPage" data-role="page" data-theme="a">

    <div data-theme="a" data-role="header" id="header">
                <strong id="WINGS">Wisconsin Mapping Tool</strong>
     </div>

    <div data-role="content" data-theme="a">    

        <form id="loginForm" data-theme="a">
        <div data-role="fieldcontain" class="ui-hide-label" data-theme="a">
            <label for="email">Email:</label>
            <input type="text" name="email" id="email" value="" placeholder="Email" />
        </div>

        <div data-role="fieldcontain" class="ui-hide-label" data-theme="a"> 
            <label for="password">Password:</label>
            <input type="password" name="password" id="password" value="" placeholder="Password" />
        </div>

        
        </form>
        <button data-role="button" id="loginBtn" data-theme="a">Login</button>
    </div>

        <div data-theme="a" data-role="footer">
        <h3>
            UW-Madison
        </h3>
    </div>
<script language="javascript" type="text/javascript" src="js/index.js"></script>

</div>

<div id="tasksPage" data-role="page" data-theme="a">
        <div data-theme="a" data-role="header" id="header">
                <strong id="WINGS">Wisconsin Mapping Tool</strong>
     </div>


<div data-role="content" data-theme="a">    
        <ul data-role="listview" data-divider-theme="a" data-inset="false">
            <li data-role="list-divider" role="heading">
                Current Tasks
            </li>
            <li data-theme="a">
                <a href="data_entry.html" data-transition="slide">
                    Task 1
                </a>
            </li>
            <li data-theme="a">
                <a href="data_entry.html" data-transition="slide">
                    Task 2
                </a>
            </li>
            <li data-theme="a">
                <a href="data_entry.html" data-transition="slide">
                    Task 3
                </a>
            </li>
        </ul> 
</div>


    <div data-theme="a" data-role="footer">
        <h3>
            UW-Madison
        </h3>
    </div>
</div>

</body>
<script>

function init() {

 document.addEventListener("deviceready", deviceReady, true);
 delete init;
}

$("#loginBtn").click(function (e) {

        var u = $("#email").val();
        var p = $("#password").val();
        alert(u);
        alert(p);

        $.ajax({
        url: "http://localhost:3000/users/sign_in.json",
        type: "POST",
      
        data: JSON.stringify({user: {email: u, password: p}}),
        dataType: "json",
        contentType: "application/json; charset=utf-8",
        success: function(data){
            alert(data.error);

            $(':mobile-pagecontainer').pagecontainer('change', '#tasksPage', {
        transition: 'flip',
        changeHash: false,
        reverse: true,
        showLoadMsg: true
    });
             
        },
        
        error: function(error) {
            alert(error.responseText)
            alert("error alert");
        }
        
        });


$(document).on("pagecreate", "#tasksPage", function( event ) {
        $.ajax({
        url: "http://localhost:3000/users/1/assignments",
        type: "POST",
      
        data: JSON.stringify({user: {id: 1}}),
        dataType: "json",
        contentType: "application/json; charset=utf-8",
        success: function(data){
            console.log(data);

            $(':mobile-pagecontainer').pagecontainer('change', '#tasksPage', {
        transition: 'flip',
        changeHash: false,
        reverse: true,
        showLoadMsg: true
    });
             
        },
        
        error: function(error) {
            alert(error.responseText)
            alert("error alert");
        }
        
        });





});



});
</script>
</html>